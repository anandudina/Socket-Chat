<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Socket Chat</title>
    <!-- bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />
    <!-- gfonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Alata&family=Alfa+Slab+One&family=Bangers&family=Calligraffitti&family=Cookie&family=Julius+Sans+One&family=Kalam:wght@300;400;700&family=Major+Mono+Display&family=Monoton&family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Pacifico&family=Paprika&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway:ital,wght@0,100..900;1,100..900&family=Sometype+Mono:ital,wght@0,400..700;1,400..700&display=swap"
      rel="stylesheet"
    />
    <!-- boxicons -->
     <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  </head>
   <style>
    body {
      font-family: "Open Sans", sans-serif;
    }
    #chatWrapper {
      height: 95vh; 
      width: 55vw;
    }
    #messageArea {
      flex: 1;              
      height: 70vh;        
      overflow-y: auto;     
      background-color: #f8f9fa;
    }
    .message {
      max-width: 70%;
      margin-bottom: 10px;
      padding: 8px 12px;
      border-radius: 12px;
      word-wrap: break-word;
      clear: both;
    }
    .message.self {
      background-color: #d1f7c4;
      margin-left: auto;
      text-align: right;
    }
    .message.other {
      background-color: #e9ecef;
      margin-right: auto;
      text-align: left;
    }
    .message strong {
      display: block;
      font-weight: 600;
      margin-bottom: 2px;
    }
    .form-control:focus {
  box-shadow: none !important;
  outline: none !important;
}
  </style>
</head>
<body class="bg-dark">
  <div class=" d-flex justify-content-center align-items-center mt-3">
    <div id="chatWrapper" class="container p-3 d-flex flex-column ">
      <div class="d-flex justify-content-between align-items-center bg-success rounded-4 rounded-bottom-0  p-2">
        <h2 class="text-white ms-3 fs-4 ">Socket Chat</h2>
         <input class="form-control w-25 rounded-pill" autocomplete="off" type="text" placeholder="Name" id="myname" required />
      </div>
  
      
      <div id="messageArea" class="position-relative rounded-4 p-4 rounded-top-0 ">
  
      
      <div class="position-absolute bottom-0 start-0 mb-2 w-100 px-2">
        <form class="mt-3 d-flex  w-100 gap-1 " id="form">
         
          <input class="form-control rounded-pill" autocomplete="off" type="text" placeholder="Message" id="message" required />
          <button class="btn btn-success rounded-circle" type="submit"><i class='bx bxs-send'></i></button>
        </form>
      </div>
      </div>
    </div>
  </div>

  <script>
    // WebSocket connection
    const socket = new WebSocket("ws://localhost:8080");
    const form = document.getElementById("form");
    const nameInput = document.getElementById("myname");
    const msgInput = document.getElementById("message");
    const messageArea = document.getElementById("messageArea");

    function addMessage(sender, text, type = "other") {
      const div = document.createElement("div");
      div.classList.add("message", type);
      div.innerHTML = `<strong style="color:${type === "self" ? "#2e7d32" : "#0d6efd"}">${sender}</strong> ${text}`;
      messageArea.appendChild(div);
      messageArea.scrollTop = messageArea.scrollHeight;
    }

    socket.addEventListener("message", (event) => {
      const [sender, ...msgParts] = event.data.split(": ");
      const msg = msgParts.join(": ");
      if (sender === nameInput.value.trim()) return;
      addMessage(sender, msg, "other");
    });

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const name = nameInput.value.trim();
      const msg = msgInput.value.trim();
      if (name && msg) {
        const fullMsg = `${name}: ${msg}`;
        socket.send(fullMsg);
        addMessage("You", msg, "self");
        msgInput.value = "";
      }
    });
    msgInput.addEventListener("keypress", (e) => {
  if (e.key === "Enter") {
    e.preventDefault();
    form.dispatchEvent(new Event("submit"));
  }
});
  </script>
</body>
</html>